<!DOCTYPE html>
<html>
<head>
  <title>GDP per Capita Comparison: Hong Kong, Korea, Japan, Singapore, and mainland China</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<body>
  <h1>GDP per Capita Comparison: Hong Kong, Korea, Japan, Singapore, and mainland China</h1>
  <p>This web page serves as a platform for visualizing and exploring the economic trends and comparisons among the regions of Hong Kong, South Korea, Japan, Singapore, and mainland China.</p>
    
  <p>Specifically, the focus is on the evolution of GDP per capita across these regions following Hong Kong's historic transition of sovereignty from the United Kingdom to China in 1997.</p>
    
  <p>This significant event marked a turning point in Hong Kong's economic landscape and provides a unique backdrop for examining the subsequent trajectories of economic growth.</p>
  
  <!-- Div for the D3.js line chart -->
  <div id="d3_chart"></div>
  
  <!-- Div for the Google Charts line chart -->
  <div id="google_chart"></div>

  <script>
    // Load data from CSV file
    d3.csv('https://raw.githubusercontent.com/harperdaboss/DSCI554A1/main/filtered_data.csv', d => ({
      Country: d.Country,
      Year: parseInt(d.Year), // Parse as integer
      Value: +d['GDP per capita (US dollars)']
    })).then(data => {
      // Set up the SVG canvas dimensions
      const margin = { top: 20, right: 30, bottom: 40, left: 40 };
      const width = 800 - margin.left - margin.right;
      const height = 400 - margin.top - margin.bottom;

      // Create the SVG canvas for D3.js chart
      const svgD3 = d3.select("#d3_chart")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

      // Set up scales for x and y axes
      const xScale = d3.scaleLinear()
        .domain(d3.extent(data, d => d.Year))
        .range([0, width]);

      const yScale = d3.scaleLinear()
        .domain([0, d3.max(data, d => d.Value)])
        .range([height, 0]);

      // Define the line generator
      const line = d3.line()
        .x(d => xScale(d.Year))
        .y(d => yScale(d.Value));

      // Append an SVG path element to represent the line chart
      svgD3.append("path")
        .datum(data)
        .attr("class", "line")
        .attr("d", line);

      // Add x-axis
      svgD3.append("g")
        .attr("transform", `translate(0, ${height})`)
        .call(d3.axisBottom(xScale));

      // Add y-axis
        svgD3.append("g")
        .call(d3.axisLeft(yScale));


      // Load Google Charts library and call the line chart creation function
      google.charts.load('current', { packages: ['corechart'] });
      google.charts.setOnLoadCallback(() => createLineChart(data, ['Hong Kong', 'South Korea', 'Japan', 'Singapore', 'China']));
    });

    // Function to create Google Charts line chart
    function createLineChart(data, countries) {
      data.sort((a, b) => a.Year - b.Year);

      // Create a data table
      const dataTable = new google.visualization.DataTable();
      dataTable.addColumn('string', 'Year');
      countries.forEach(country => {
        dataTable.addColumn('number', country);
      });

      // Fill data into the data table
      const years = Array.from(new Set(data.map(d => d['Year'])));
      years.forEach(year => {
        const row = [year.toString()];
        countries.forEach(country => {
          const value = data.find(d => d['Country'] === country && d['Year'] === year);
          row.push(value ? parseFloat(value['GDP per capita (US dollars)']) : null);
        });
        dataTable.addRow(row);
      });

      // Set up chart options
      const options = {
        title: 'GDP per Capita Comparison',
        curveType: 'function',
        legend: { position: 'bottom' },
        hAxis: { title: 'Year' },
        vAxis: { title: 'GDP per Capita (US dollars)' },
      };

      // Create and draw the Google Charts line chart
      const chart = new google.visualization.LineChart(document.getElementById('google_chart'));
      chart.draw(dataTable, options);
    }
  </script>
</body>
</html>
